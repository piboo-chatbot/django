{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë§ˆì´í˜ì´ì§€ - PiBoo</title>
  <link rel="stylesheet" href="{% static 'style/mypage.css' %}">
  <style>
    /* ìµœê·¼ ëŒ€í™” ì˜ì—­ì„ ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¸°ê¸° */
    .mypage-history {
      display: none;
      margin-top: 20px;
    }

    .toggle-btn {
      margin-top: 20px;
      background: #ff3b5c;
      color: #fff;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 700;
      padding: 12px 20px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .toggle-btn:hover {
      background: #fff;
      color: #ff3b5c;
      border: 2px solid #ff3b5c;
    }
  </style>
</head>
<body>
  <div class="mypage-container">
    <h1>ë§ˆì´í˜ì´ì§€</h1>
    <div class="profile-info">
      <span class="profile-label">ë‹‰ë„¤ì„:</span>
      <span class="profile-value">{{ user.nickname }}</span>
      <span class="profile-label">ë‚˜ì´:</span>
      <span class="profile-value">{{ user.age }}</span>
      <span class="profile-label">ì„±ë³„:</span>
      <span class="profile-value">
        {% if user.gender == 0 %}ë‚¨ì
        {% elif user.gender == 1 %}ì—¬ì
        {% else %}-{% endif %}
      </span>
    </div>

    <div class="mypage-stats">
      <h2>ë‚˜ì˜ í”¼ë¶€ í†µê³„</h2>
      <div class="stat-item">
        <span>âœ¨ ì¶”ì²œë°›ì€ í™”ì¥í’ˆ:</span> <strong>12ê°œ</strong>
      </div>
      <div class="stat-item">
        <span>ğŸ“ ì§ˆë¬¸ ìˆ˜:</span> <strong>34íšŒ</strong>
      </div>
    </div>

    <!-- ìµœê·¼ ëŒ€í™” ë³´ê¸° ë²„íŠ¼ -->
    <button class="toggle-btn" onclick="toggleHistory()">ìµœê·¼ ëŒ€í™” ë³´ê¸°</button>

    <!-- ìµœê·¼ ëŒ€í™” ì˜ì—­ (ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€) -->
      <div class="mypage-history" id="history-container">
      <h2>ìµœê·¼ ëŒ€í™”</h2>
      {% for log in chat_logs %}
      <div class="chat-item">
        <div class="chat-question">
          <span class="chat-icon">ğŸ’¬</span> {{ log.question }}
        </div>
        <div class="chat-answer">
          <span class="chat-icon">ğŸŒ¸</span> {{ log.answer|truncatechars:100|linebreaksbr|safe }}
        </div>
      </div>
      <hr class="chat-divider">
    {% empty %}
      <p class="no-chat">ìµœê·¼ ëŒ€í™” ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endfor %}
    </div>



    <div class="mypage-routine">
      <h2>ë‚˜ë§Œì˜ ë·°í‹° ë£¨í‹´</h2>
      <p>ğŸŒ ì•„ì¹¨: í´ë Œì € â†’ í† ë„ˆ â†’ ì„¸ëŸ¼</p>
      <p>ğŸŒ™ ë°¤: í´ë Œì € â†’ í† ë„ˆ â†’ ì—ì„¼ìŠ¤ â†’ í¬ë¦¼</p>
    </div>

    <div class="actions">
      <button onclick="location.href='{% url 'chatbot' %}'">ì±„íŒ…ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit">ë¡œê·¸ì•„ì›ƒ</button>
      </form>
    </div>
  </div>

  <script>
    function toggleHistory() {
      const history = document.getElementById('history-container');
      if (history.style.display === 'none' || history.style.display === '') {
        history.style.display = 'block';
      } else {
        history.style.display = 'none';
      }
    }
  </script>
</body>
</html>
